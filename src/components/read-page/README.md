# 阅读器组件说明

## 功能概述

基于tReader的阅读功能，实现了完整的电子书阅读体验，包括：

### 核心功能

- ✅ **双阅读模式**: 滚动模式和翻页模式
- ✅ **智能分页**: 自动计算页面内容，支持翻页动画
- ✅ **阅读设置**: 字体大小、行间距、主题、字体等个性化设置
- ✅ **进度保存**: 自动保存和恢复阅读进度
- ✅ **章节导航**: 自动识别章节，支持快速跳转
- ✅ **阅读统计**: 显示阅读时长、进度等统计信息

### 交互功能

- ✅ **键盘快捷键**: 支持方向键、空格键、ESC等快捷键
- ✅ **触摸手势**: 支持滑动翻页、点击操作
- ✅ **自动滚动**: 可调节速度的自动滚动功能
- ✅ **主题切换**: 浅色、深色、护眼、绿色四种主题

## 组件结构

```
read-page/
├── read-page.tsx          # 主阅读器组件
├── flip-reader.tsx        # 翻页模式组件
├── chapter-navigation.tsx # 章节导航组件
├── reading-stats.tsx      # 阅读统计组件
└── README.md             # 说明文档
```

## 使用方法

### 1. 路由配置

```tsx
// 在路由中添加阅读器页面
{
  path: '/reader/:bookId',
  element: <ReadPage />
}
```

### 2. 基本使用

```tsx
import { ReadPage } from '@/components/read-page/read-page';

// 通过路由参数 bookId 加载对应书籍
// URL: /reader/123
```

### 3. 键盘快捷键

- `←/→` 或 `PageUp/PageDown`: 翻页
- `空格键`: 开始/停止自动滚动
- `ESC`: 退出阅读器或停止自动滚动
- `S`: 打开设置面板
- `M`: 打开菜单面板
- `C`: 打开章节导航

### 4. 触摸操作

- **左右滑动**: 翻页
- **点击屏幕**: 显示/隐藏控制栏
- **双击**: 开始自动滚动

## 服务模块

### 阅读设置服务 (`reading-settings.ts`)

- 管理用户的阅读偏好设置
- 支持主题、字体、布局等设置
- 自动保存到本地存储

### 阅读进度服务 (`reading-progress.ts`)

- 保存和恢复阅读进度
- 记录阅读时长和统计信息
- 支持多本书的进度管理

## 技术特性

### 性能优化

- 虚拟滚动和分页渲染
- 防抖保存进度
- 懒加载和按需渲染

### 响应式设计

- 适配不同屏幕尺寸
- 支持横竖屏切换
- 移动端友好的触摸交互

### 可访问性

- 键盘导航支持
- 屏幕阅读器兼容
- 高对比度主题

## 扩展功能

### 已实现

- [x] 基础阅读功能
- [x] 翻页模式
- [x] 阅读设置
- [x] 进度保存
- [x] 章节导航
- [x] 阅读统计

### 可扩展

- [ ] 书签功能
- [ ] 笔记标注
- [ ] 语音朗读
- [ ] 字体下载
- [ ] 阅读模式（夜间模式等）
- [ ] 分享功能
- [ ] 云端同步

## 注意事项

1. **文件格式**: 目前主要支持TXT格式，EPUB支持需要额外解析
2. **章节识别**: 基于正则表达式识别章节标题，可能需要根据具体书籍格式调整
3. **性能**: 大文件（>10MB）可能需要优化分页算法
4. **存储**: 使用localStorage存储设置和进度，有容量限制

## 开发建议

1. 根据实际需求调整章节识别规则
2. 优化大文件的分页性能
3. 添加更多主题和字体选项
4. 实现书签和笔记功能
5. 支持更多文件格式（EPUB、PDF等）

